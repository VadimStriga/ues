<!-- templates/counterparties/counterparty_detail.html -->
{% extends 'base.html' %}

{% block title %}
  {{ counterparty.short_name }}
{% endblock title %}

{% block content %}
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/table_sort.css' %}">
  <script src="{% static 'js/table_sort.js' %}"></script>
  <main>
    <div class="row">
      <div class="col-lg-3 col-md-12">
        <ul class="list-group list-group-flush">
          <li class="list-group-item">
            Полное наименование: {{ counterparty.full_name }}
          </li>
          <li class="list-group-item">
            Сокращенное наименование: {{ counterparty.short_name }}
          </li>
          <li class="list-group-item">
            Юридический адрес: {{ counterparty.address }}
          </li>
          <li class="list-group-item">
            ОГРН: {{ counterparty.main_state_registration_number }}
          </li>
          <li class="list-group-item">
            ИНН: {{ counterparty.tax_identification_number }}
          </li>
          <li class="list-group-item">
            КПП: {{ counterparty.registration_reason_code }}
          </li>
          <li class="list-group-item">
            Контактный телефон: {{ counterparty.phone_number }}
          </li>
          <li class="list-group-item">
            Электронная почта: {{ counterparty.email }}
          </li>
          <li class="list-group-item">
            Руководитель организации:
            {{ counterparty.job_title }}
            {{ counterparty.person_full_name }}
          </li>
        </ul>
        <buttomn>
          <a class="btn btn-primary" href="{% url 'counterparties:counterparty_edit' counterparty.pk %}">Редактировать контрагента</a>
          <a class="btn btn-danger" onclick="return confirm('Вы уверены что хотите удалить контрагента?');" href="{% url 'counterparties:counterparty_delete' counterparty.pk %}">Удалить контрагента</a>
        </buttomn>
      </div>
      <div class="col-9">
        <h3>Всего договоров: {{ contracts_count }}</h3>
        <buttomn>
          <a class="btn btn-primary me-2" href="{% url 'counterparties:contract_create' counterparty.pk %}"> Добавить договор</a>
        </buttomn>
        <br>
        {% if contracts %}
          <br>
            <table class="table table-striped table-hover table_sort">
              <thead class="table-dark">
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Номер договора</th>
                  <th scope="col">Дата заключения</th>
                  <th scope="col" title= "Идентификационный код закупки на сайте https://zakupki.gov.ru/">ИКЗ</th>
                  <th scope="col">Цена договора</th>
                  <th scope="col">Объект закупки</th>
                  <th scope="col">Дата завершения работ</th>
                  <th scope="col">Фактическая стоимость выполненных работ</th>
                </tr>
              </thead>
              <tbody>
                {% for contract in contracts %}
                  <tr>
                    <td scope="row"></th>
                    <td>
                     <a href="{% url 'counterparties:contract_detail' contract.id %}">
                     {{ contract.title }}
                     </a>
                    </td>
                    <td>{{ contract.conclusion_date }}</td>
                    <td>{{ contract.purchase_code }}</td>
                    <td>{{ contract.contract_price }}</td>
                    <td>{{ contract.description }}</td>
                    <td>{% if contract.сompletion_date %}{{ contract.сompletion_date }} {% endif %}</td>
                    <td> {% if contract.actual_cost %}{{ contract.actual_cost }}{% endif %}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </br>
          <buttomn>
            <a class="btn btn-primary" href="#">Добавить точку учёта электроэнергии</a>
          </buttomn>
        {% endif %}
      </div> 
    </div>
  </main>
{% endblock content %}